#!/bin/bash

start_boinc(){
	echo -e "[ \e[93mStarting\e[0m ] BOINC daemon"
	boinc -daemon --allow_remote_gui_rpc --dir $BOINC_DATADIR && \
		echo -e "[ \e[92mRunning\e[0m ]] BOINC\n"
}

start_grcd(){
	echo "[ \e[93mStarting\e[0m ] GRC client daemon"

	GRC_CMD="/usr/bin/gridcoinresearchd -daemon -server -shrinkdebugfile -upnp \
			-rpcuser=$GRC_USERNAME -rpcpassword=$GRC_PASSWD \
			-blocknotify='exec /usr/bin/grcupdate'"

	if [! $(pgrep gridcoinresearchd) ]; then
		# Start Gridcoin client
		if [ -f $GRC_DATADIR/gridcoinresearch.conf ] ; then
			# .GridcoinResearch folder is correctly mounted
			$GRC_CMD && echo -e "[ \e[92mRunning\e[0m ] gridcoinresearchd\n"
		else
			echo "[ \e[93mError\e[0m ] "'gridcoinresearch.conf not found!'
		fi
	else
		# Gridcoin client already running; "do nothing".
		# Uncomment below to specify what to do
		#/usr/bin/gridcoinresearchd $@
		echo "[ \e[92mRunning\e[0m ] gridcoinresearchd already running."
	fi
}

# Instance Init #############
case $1 in
"")
	start_boinc
	start_grcd
	;;
b|boinc)
	start_boinc
	;;
g|grc|grcd|gridcoin)
	start_grcd
	;;
*)
	echo usage:
	echo $(basename $0)
	echo -e "\tRun All"
	echo "$(basename $0) [b|g]"
	echo -e "\tb\tStart BOINC"
	echo -e "\tg\tStart Gridcoin Daemon (gridcoinresearchd)"
	echo ""
esac

